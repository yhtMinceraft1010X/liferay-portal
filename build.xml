<?xml version="1.0"?>

<project basedir="." default="compile" name="portal" xmlns:antelope="antlib:ise.antelope.tasks" xmlns:artifact="antlib:org.apache.maven.artifact.ant" xmlns:if="ant:if">
	<import file="build-common.xml" />

	<macrodef name="clean-liferay-home">
		<sequential>
			<parallel failonany="true" threadcount="${parallel.thread.count}">
				<delete failonerror="false" includeemptydirs="true">
					<fileset
						dir="${app.server.bin.dir}"
						includes="*.log*"
					/>
					<fileset
						dir="${app.server.classes.portal.dir}"
						includes="portal-*.properties,system-*.properties"
					/>
					<fileset
						dir="${app.server.deploy.dir}"
						includes="*-ext/**,*-ext.war/**,*-hook/**,*-hook.war/**,*-layouttpl/**,*-layouttpl.war/**,*-portlet/**,*-portlet.war/**,*-theme/**,*-theme.war/**,*-web/**,*-web.war/**"
					/>
					<fileset
						dir="${app.server.lib.global.dir}"
					/>
					<fileset
						dir="${liferay.home}"
						includes=".liferay-home"
					/>
					<fileset
						dir="${liferay.home}/data/elasticsearch"
					/>
					<fileset
						dir="${liferay.home}/data/hypersonic"
						includes="${database.name}.*"
					/>
					<fileset
						dir="${liferay.home}/deploy"
					/>
					<fileset
						dir="${liferay.home}/osgi"
					/>
					<fileset
						dir="${liferay.home}/work"
					/>
				</delete>

				<if>
					<equals arg1="${clean.log.dir}" arg2="true" />
					<then>
						<delete dir="${app.server.log.dir}" />
					</then>
				</if>

				<if>
					<not>
						<and>
							<equals arg1="${app.server.type}" arg2="tomcat" />
							<antelope:endswith string="${app.server.portal.dir}" with="/portal-web/docroot" />
						</and>
					</not>
					<then>
						<delete dir="${app.server.portal.dir}" failonerror="false" />
						<delete failonerror="false" file="${app.server.portal.dir}" />
					</then>
					<else>
						<delete failonerror="false">
							<fileset
								dir="${app.server.shielded-container-lib.portal.dir}"
								excludes="${jdbc.drivers}"
							/>
						</delete>
					</else>
				</if>

				<if>
					<equals arg1="${clean.temp.dir}" arg2="true" />
					<then>
						<delete dir="${app.server.temp.dir}" />
					</then>
				</if>

				<if>
					<equals arg1="${clean.work.dir}" arg2="true" />
					<then>
						<delete dir="${app.server.work.dir}" />
					</then>
				</if>
			</parallel>
		</sequential>
	</macrodef>

	<macrodef name="setup-profile-dxp">
		<attribute name="to.branch.name" />

		<sequential>

			<!-- build.profile-dxp.properties -->

			<echo>build.profile-dxp.properties</echo>

			<loadproperties prefix="working.dir" srcFile="working.dir.properties" />

			<condition else="7z" property="snapshot.bundle.file.extension" value="zip">
				<equals arg1="${git.working.branch.name}" arg2="7.0.x" />
			</condition>

			<echo file="build.profile-dxp.properties">##
## Autogenerated
##

build.profile=dxp
build.repository.private.password=${working.dir.build.repository.private.password}
build.repository.private.url=${working.dir.build.repository.private.url}
build.repository.private.username=${working.dir.build.repository.private.username}

snapshot.bundle.base.url=${working.dir.snapshot.bundle.base.url}
snapshot.bundle.url=${working.dir.snapshot.bundle.base.url}snapshot-${git.working.branch.name}-private/latest/liferay-portal-tomcat-${git.working.branch.name}-private.${snapshot.bundle.file.extension}</echo>

			<!-- release.profile-dxp.properties -->

			<echo>release.profile-dxp.properties</echo>

			<echo file="release.profile-dxp.properties">##
## Autogenerated
##

lp.version=${lp.version[@{to.branch.name}]}

release.info.build=${release.info.build[@{to.branch.name}]}
release.info.date=${release.info.date[@{to.branch.name}]}
release.info.name=${release.info.name[@{to.branch.name}]}
release.info.version=${release.info.version.major[@{to.branch.name}]}.${release.info.version.minor[@{to.branch.name}]}.${release.info.version.bug.fix[@{to.branch.name}]}
release.info.version.bug.fix=${release.info.version.bug.fix[@{to.branch.name}]}
release.info.version.display.name=${release.info.version.display.name[@{to.branch.name}]}
release.info.version.file.suffix=${release.info.version.file.suffix[@{to.branch.name}]}
release.info.version.major=${release.info.version.major[@{to.branch.name}]}
release.info.version.minor=${release.info.version.minor[@{to.branch.name}]}</echo>

			<!-- sql/sql.profile-dxp.properties -->

			<echo>sql/sql.profile-dxp.properties</echo>

			<local name="portal.data.release.build.number" />

			<condition else="" property="portal.data.release.build.number" value="portal.data.release.build.number=${portal.data.release.build.number[@{to.branch.name}]}">
				<isset property="portal.data.release.build.number[@{to.branch.name}]" />
			</condition>

			<local name="portal.data.release.schema.version" />

			<condition else="" property="portal.data.release.schema.version" value="portal.data.release.schema.version=${portal.data.release.schema.version[@{to.branch.name}]}">
				<isset property="portal.data.release.schema.version[@{to.branch.name}]" />
			</condition>

			<echo file="sql/sql.profile-dxp.properties">##
## Autogenerated
##

database.types=${database.types[@{to.branch.name}]}

${portal.data.release.build.number}
${portal.data.release.schema.version}</echo>

			<!-- test.profile-dxp.properties -->

			<echo>test.profile-dxp.properties</echo>

			<echo file="test.profile-dxp.properties">##
## Autogenerated
##

liferay.portal.branch=@{to.branch.name}

test.run.environment=EE

testray.build.type=EE Development (${liferay.portal.branch})</echo>
		</sequential>
	</macrodef>

	<target name="all">
		<if>
			<not>
				<or>
					<equals arg1="${build.binaries.cache.dir}" arg2="" />
					<available file="${project.dir}/${build.binaries.cache.dir}" type="dir" />
				</or>
			</not>
			<then>
				<property location="${project.dir}/${build.binaries.cache.dir}" name="build.binaries.cache.dir.absolute.path" />

				<echo>
Please clone the repository at https://github.com/liferay/${build.binaries.cache.repository.name}
into ${build.binaries.cache.dir.absolute.path} to have a cached copy of all
Gradle dependencies used during the build.

Set the property "build.binaries.cache.dir" to an empty value to suppress this
message.
				</echo>
			</then>
		</if>

		<property name="gradle.execute.silent" value="true" />

		<antcall target="clean" />

		<antcall target="compile" />

		<antcall target="deploy" />
	</target>

	<target name="baseline-current-branch">
		<java
			classname="com.liferay.portal.tools.GitUtil"
			classpathref="project.classpath"
			dir="${project.dir}/modules"
			fork="true"
			newenvironment="true"
			outputProperty="baseline.current.branch.dirs"
			resultproperty="baseline.current.branch.result"
		>
			<arg value="git.marker.file=bnd.bnd" />
			<arg value="git.working.branch.name=${git.working.branch.name}" />
			<arg value="tools.throw.main.exception=true" />
		</java>

		<if>
			<not>
				<equals arg1="${baseline.current.branch.result}" arg2="0" />
			</not>
			<then>
				<fail>${baseline.current.branch.dirs}</fail>
			</then>
		</if>

		<for delimiter="${line.separator}" list="${baseline.current.branch.dirs}" param="baseline.current.branch.dir">
			<sequential>
				<if>
					<not>
						<contains string="@{baseline.current.branch.dir}" substring=" " />
					</not>
					<then>
						<propertyregex
							global="true"
							input="@{baseline.current.branch.dir}"
							override="true"
							property="baseline.current.branch.project.path"
							regexp="/"
							replace=":"
						/>

						<gradle-execute dir="${project.dir}/modules" forcedcacheenabled="false" task=":${baseline.current.branch.project.path}:baseline">
							<arg value="--parallel" />
							<arg value="-Dbaseline.ignoreFailures=true" />
						</gradle-execute>
					</then>
				</if>
			</sequential>
		</for>
	</target>

	<target name="bom-all">
		<echo>Manually run "ant all" or "ant snapshot-bundle" to initialize the bundle.</echo>

		<setup-sdk />

		<gradle-execute setupbinariescache="false" task="deployReleng">
			<arg value="--build-file=${project.dir}/modules/releng.gradle" />
		</gradle-execute>
	</target>

	<target name="clean">
		<gradle-stop-daemon />

		<if>
			<available file="${project.dir}/.git" />
			<then>
				<execute>
					${build.git.clean.command}
				</execute>
			</then>
			<else>
				<echo>Do not clean project because it is not in a Git repository.</echo>
			</else>
		</if>

		<clean-liferay-home />

		<print-current-time />
	</target>

	<target name="compile">
		<setup-sdk />

		<setup-libs />
		<setup-yarn />

		<gradle-execute dir="modules/core" task="deploy">
			<arg value="--parallel" />
			<arg value="-Dbuild.profile=portal-pre" />
			<arg value="-Pforced.deploy.dir=${project.dir}/tmp/lib-pre" />
		</gradle-execute>

		<ant dir="portal-kernel" inheritAll="false" target="install-portal-snapshot" />

		<gradle-execute dir="modules/apps" task="deploy">
			<arg value="--parallel" />
			<arg value="-Dbuild.profile=portal-pre" />
			<arg value="-Pforced.deploy.dir=${project.dir}/tmp/lib-pre" />
		</gradle-execute>

		<parallel failonany="true" threadcount="${parallel.thread.count}">
			<ant dir="support-tomcat" inheritAll="false" target="compile" />
			<ant dir="util-bridges" inheritAll="false" target="compile" />

			<sequential>
				<ant dir="util-java" inheritAll="false" target="compile" />
				<ant dir="util-taglib" inheritAll="false" target="compile" />
			</sequential>

			<ant dir="util-slf4j" inheritAll="false" target="compile" />
		</parallel>

		<ant dir="portal-impl" inheritAll="false" target="compile" />

		<ant dir="portal-test" inheritAll="false" target="compile" />

		<print-current-time />
	</target>

	<target name="compile-test">
		<ant dir="portal-impl" inheritAll="false" target="compile-test" />
		<ant dir="portal-kernel" inheritAll="false" target="compile-test" />
		<ant dir="portal-web" inheritAll="false" target="compile-test" />
		<ant dir="util-java" inheritAll="false" target="compile-test" />
	</target>

	<target name="deploy">
		<if>
			<equals arg1="${app.server.type}" arg2="websphere" />
			<then>
				<delete file="${app.server.portal.war.name}" />
			</then>
		</if>

		<if>
			<and>
				<equals arg1="${app.server.type}" arg2="tomcat" />
				<not>
					<available file="${app.server.tomcat.classes.global.dir}/catalina.jar" />
				</not>
			</and>
			<then>
				<ant antfile="build-dist.xml" target="unzip-tomcat" />
			</then>
		</if>

		<ant dir="portal-kernel" inheritAll="false" target="deploy" />

		<ant dir="util-bridges" inheritAll="false" target="deploy" />
		<ant dir="util-java" inheritAll="false" target="deploy" />
		<ant dir="util-slf4j" inheritAll="false" target="deploy" />
		<ant dir="util-taglib" inheritAll="false" target="deploy" />

		<ant dir="portal-impl" inheritAll="false" target="deploy" />

		<ant dir="portal-test" inheritAll="false" target="deploy" />
		<ant dir="portal-web" inheritAll="false" target="deploy" />

		<antcall target="install-portal-snapshots" />

		<touch file="${liferay.home}/.liferay-home" />

		<parallel failonany="true" threadcount="${parallel.thread.count}">
			<sequential>
				<ant dir="sql" inheritAll="false" target="build-db" />
				<ant dir="sql" inheritAll="false" target="rebuild-hypersonic" />
			</sequential>
		</parallel>

		<copy
			todir="${liferay.home}/data/hypersonic"
		>
			<fileset
				dir="sql"
			>
				<include name="${database.name}.properties" />
				<include name="${database.name}.script" />
			</fileset>
		</copy>

		<deploy-properties />

		<antcall target="deploy-additional-jars" />

		<antcall target="update-app-server-scripts" />

		<mkdir dir="${app.server.log.dir}" />
		<mkdir dir="${app.server.temp.dir}" />
		<mkdir dir="${app.server.work.dir}" />

		<if>
			<equals arg1="${app.server.type}" arg2="websphere" />
			<then>
				<copy
					file="${app.server.portal.dir}/WEB-INF/ibm-web-ext.xml"
					tofile="${app.server.websphere.instance.dir}/config/cells/liferay-cell/applications/liferay-portal.ear/deployments/liferay-portal/liferay-portal.war/WEB-INF/ibm-web-ext.xml"
				/>
			</then>
		</if>

		<ant dir="portal-web" inheritAll="false" target="war" />

		<stopwatch name="modules.stopwatch" />

		<if>
			<equals arg1="${build.marketplace.apps.enabled}" arg2="true" />
			<then>
				<gradle-execute dir="${project.dir}/modules" task="deploy">
					<arg value="--parallel" />
					<arg value="-Dbuild.profile=portal-pre" />
				</gradle-execute>

				<gradle-execute dir="${project.dir}/modules" task="deploy">
					<arg value="--parallel" />
					<arg value="-Dbuild.exclude.dirs=${build.exclude.dirs}" />
					<arg value="-Dbuild.include.dirs=${build.include.dirs}" />
					<arg value="-Dbuild.profile=${build.profile}" />
					<arg if:true="${gradle.build.scan.enabled}" value="-Dgradle.build.scan.enabled=true" />
					<arg if:set="gradle.build.scan.server.url" value="-Dgradle.build.scan.server.url=${gradle.build.scan.server.url}" />
					<env key="WAS_HOME" value="${app.server.websphere.dir}" />
				</gradle-execute>

				<if>
					<equals arg1="${marker.files.lfrbuild.ci.enabled}" arg2="true" />
					<then>
						<if>
							<resourcecount count="0" when="gt">
								<fileset
									dir="${project.dir}/modules"
									includes="**/.lfrbuild-ci"
								/>
							</resourcecount>
							<then>
								<gradle-execute dir="${project.dir}/modules" task="deploy">
									<arg value="--parallel" />
									<arg value="-Ddeploy.only.profile=ci" />
								</gradle-execute>
							</then>
						</if>
					</then>
				</if>
			</then>
			<else>
				<gradle-execute dir="${project.dir}/modules/core" task="deploy">
					<arg value="--parallel" />
					<arg value="-Dbuild.exclude.dirs=${build.exclude.dirs}" />
					<arg value="-Dbuild.include.dirs=${build.include.dirs}" />
					<arg value="-Dbuild.profile=${build.profile}" />
				</gradle-execute>

				<pathconvert property="build.app.server.lib.marker.files" setonempty="false">
					<fileset
						dir="${project.dir}/modules"
						includes="**/.lfrbuild-app-server-lib"
					/>
				</pathconvert>

				<if>
					<isset property="build.app.server.lib.marker.files" />
					<then>
						<gradle-execute dir="${project.dir}/modules" task="deployTool">
							<arg value="--parallel" />
							<arg value="-Dbuild.exclude.dirs=${build.exclude.dirs}" />
							<arg value="-Dbuild.include.dirs=${build.include.dirs}" />
							<arg value="-Dbuild.profile=${build.profile}" />
							<arg value="deployAppServerLib" />
							<arg value="deployAppServerPortalFile" />
							<arg value="deployConfigs" />
						</gradle-execute>
					</then>
					<else>
						<gradle-execute dir="${project.dir}/modules" task="deployTool">
							<arg value="--parallel" />
							<arg value="-Dbuild.exclude.dirs=${build.exclude.dirs}" />
							<arg value="-Dbuild.include.dirs=${build.include.dirs}" />
							<arg value="-Dbuild.profile=${build.profile}" />
							<arg value="deployAppServerPortalFile" />
							<arg value="deployConfigs" />
						</gradle-execute>
					</else>
				</if>
			</else>
		</if>

		<stopwatch action="elapsed" name="modules.stopwatch" />

		<copy
			file="tools/osgi-marketplace-override-README.markdown"
			tofile="${liferay.home}/osgi/marketplace/override/README.markdown"
		/>

		<print-current-time />
	</target>

	<target name="deploy-additional-jars">
		<copy
			todir="${app.server.shielded-container-lib.portal.dir}"
		>
			<fileset
				dir="lib/development"
				includes="hsql.jar,mariadb.jar,mysql.jar,postgresql.jar"
			/>
		</copy>

		<if>
			<isset property="jdbc.drivers.optional.dir" />
			<then>
				<copy
					todir="${app.server.shielded-container-lib.portal.dir}"
				>
					<fileset
						dir="${jdbc.drivers.optional.dir}"
						includes="${jdbc.drivers}"
					/>
				</copy>
			</then>
		</if>

		<copy
			todir="${app.server.shielded-container-lib.portal.dir}"
		>
			<fileset
				dir="lib/portal"
				excludes="dependencies.properties"
			/>
		</copy>

		<if>
			<or>
				<equals arg1="${app.server.type}" arg2="tcserver" />
				<equals arg1="${app.server.type}" arg2="tomcat" />
			</or>
			<then>
				<if>
					<equals arg1="${app.server.type}" arg2="tomcat" />
					<then>
						<ant dir="support-tomcat" inheritAll="false" target="deploy" />
					</then>
				</if>

				<copy
					todir="${app.server.shielded-container-lib.portal.dir}"
				>
					<fileset
						dir="lib/development"
						includes="activation.jar,mail.jar"
					/>
				</copy>

				<if>
					<equals arg1="${app.server.type}" arg2="tcserver" />
					<then>
						<delete>
							<fileset
								dir="${app.server.shielded-container-lib.portal.dir}"
								includes="tomcat-juli.jar"
							/>
						</delete>
					</then>
				</if>
			</then>
		</if>

		<if>
			<equals arg1="${app.server.type}" arg2="websphere" />
			<then>
				<tstamp>
					<format pattern="yyyyMMddkkmmssSSS" property="tstamp.value" />
				</tstamp>

				<jar
					basedir="${app.server.portal.dir}"
					jarfile="${tstamp.value}"
				/>

				<delete dir="${app.server.portal.dir}" />

				<move
					file="${tstamp.value}"
					tofile="${app.server.portal.war.name}"
				/>
			</then>
		</if>
	</target>

	<target name="deploy-portal-license-enterprise-app">
		<property name="artifact.name" value="com.liferay.portal.license.enterprise.app" />

		<gradle-execute outputproperty="jar.file" setupbinariescache="false" task="printDependencyPath">
			<arg value="--build-file=${project.dir}/modules/util.gradle" />
			<arg value="--quiet" />
			<arg value="-Dorg.gradle.internal.launcher.welcomeMessageEnabled=false" />
			<arg value="-PdependencyNotation=com.liferay:${artifact.name}:${build.portal.license.enterprise.app.module.version}" />
		</gradle-execute>

		<copy
			file="${jar.file}"
			preservelastmodified="true"
			todir="${liferay.home}/osgi/static"
		/>

		<basename file="${jar.file}" property="file.name" />

		<move
			file="${liferay.home}/osgi/static/${file.name}"
			tofile="${liferay.home}/osgi/static/${artifact.name}.jar"
		/>
	</target>

	<target name="dist">
		<ant antfile="build-dist.xml" inheritAll="false" target="dist" />
	</target>

	<target name="doc">
		<antcall target="dtddoc" />
		<antcall target="javadoc" />
		<antcall target="propertiesdoc" />
		<ant dir="util-taglib" inheritAll="false" target="taglibdoc" />
	</target>

	<target name="dtddoc">
		<taskdef
			classname="DTDDoc.DTDDocTask"
			classpathref="lib.classpath"
			name="DTDDoc"
		/>

		<!--<antelope:stringutil string="${lp.version}" property="lp.version.dtd">
			<replace
				regex="\."
				replacement="_"
			/>
		</antelope:stringutil>-->

		<property name="doc.definitions.dir" value="${doc.dir}/definitions" />

		<DTDDoc
			destDir="${doc.definitions.dir}"
			docTitle="Liferay ${lp.version} Definitions"
			showFixmeTags="false"
			showHiddenTags="false"
			sourceDir="${definitions.dir}"
			stylesheet="${project.dir}/tools/styles/dtddoc.css"
		>
			<include name="liferay-*${lp.version.dtd}.dtd" />
		</DTDDoc>
	</target>

	<target name="install-portal-snapshots">
		<ant dir="portal-impl" inheritAll="false" target="install-portal-snapshot" />
		<ant dir="portal-kernel" inheritAll="false" target="install-portal-snapshot" />
		<ant dir="portal-test" inheritAll="false" target="install-portal-snapshot" />
		<ant dir="portal-web" inheritAll="false" target="install-portal-snapshot" />
		<ant dir="support-tomcat" inheritAll="false" target="install-portal-snapshot" />
		<ant dir="util-bridges" inheritAll="false" target="install-portal-snapshot" />
		<ant dir="util-java" inheritAll="false" target="install-portal-snapshot" />
		<ant dir="util-slf4j" inheritAll="false" target="install-portal-snapshot" />
		<ant dir="util-taglib" inheritAll="false" target="install-portal-snapshot" />
	</target>

	<target name="jar">
		<ant dir="portal-kernel" inheritAll="false" target="jar" />

		<ant dir="util-bridges" inheritAll="false" target="jar" />
		<ant dir="util-java" inheritAll="false" target="jar" />
		<ant dir="util-slf4j" inheritAll="false" target="jar" />
		<ant dir="util-taglib" inheritAll="false" target="jar" />

		<ant dir="portal-impl" inheritAll="false" target="jar" />
		<ant dir="portal-test" inheritAll="false" target="jar" />

		<ant dir="portal-web" inheritAll="false" target="war" />

		<ant dir="support-tomcat" inheritAll="false" target="jar" />
	</target>

	<target name="javadoc">
		<remake-dir dir="${doc.dir}/javadocs" />

		<antcall target="javadoc-portal-cmd">
			<param name="generated.description" value="" />
			<param name="module.dir" value="portal-impl" />
		</antcall>

		<antcall target="javadoc-portal-cmd">
			<param name="generated.description" value="ServiceBuilder generated this class. Modifications in this class will be overwritten the next time it is generated." />
			<param name="module.dir" value="portal-kernel" />
		</antcall>

		<antcall target="javadoc-portal-cmd">
			<param name="generated.description" value="" />
			<param name="module.dir" value="portal-test" />
		</antcall>

		<antcall target="javadoc-cmd">
			<param name="generated.description" value="" />
			<param name="module.dir" value="util-bridges" />
		</antcall>

		<antcall target="javadoc-cmd">
			<param name="generated.description" value="" />
			<param name="module.dir" value="util-java" />
		</antcall>

		<antcall target="javadoc-cmd">
			<param name="generated.description" value="" />
			<param name="module.dir" value="util-slf4j" />
		</antcall>
	</target>

	<target name="javadoc-cmd">
		<property name="doc.java.dir" value="${doc.dir}/javadocs/${module.dir}" />

		<mkdir dir="${doc.java.dir}" />

		<javadoc
			breakiterator="yes"
			classpathref="project.classpath"
			destdir="${doc.java.dir}"
			doctitle="Liferay ${lp.version} ${module.dir} API"
			encoding="UTF-8"
			header="&lt;b&gt;Liferay ${lp.version} ${module.dir}&lt;/b&gt;"
			maxmemory="2048m"
			noqualifier="java.*"
			overview="${module.dir}/src/overview.html"
			stylesheetfile="${project.dir}/tools/styles/javadoc.css"
			use="yes"
			useexternalfile="yes"
			windowtitle="Liferay ${lp.version} ${module.dir} API"
		>
			<link href="http://docs.liferay.com/portlet-api/3.0/javadocs" />
			<link href="http://java.sun.com/javase/6/docs/api" />
			<link href="http://docs.liferay.com/portal/${lp.version.major}-latest/javadocs" />

			<packageset dir="${module.dir}/src" />

			<tag description="{$generated.description}" name="generated" />
		</javadoc>
	</target>

	<target name="javadoc-portal-cmd">
		<property name="doc.java.dir" value="${doc.dir}/javadocs/${module.dir}" />

		<mkdir dir="${doc.java.dir}" />

		<javadoc
			breakiterator="yes"
			classpathref="project.classpath"
			destdir="${doc.java.dir}"
			doctitle="Liferay ${lp.version} ${module.dir} API"
			encoding="UTF-8"
			header="&lt;b&gt;Liferay ${lp.version} ${module.dir}&lt;/b&gt;"
			maxmemory="2048m"
			noqualifier="java.*"
			overview="${module.dir}/src/overview.html"
			stylesheetfile="${project.dir}/tools/styles/javadoc.css"
			use="yes"
			useexternalfile="yes"
			windowtitle="Liferay ${lp.version} ${module.dir} API"
		>
			<group packages="com.liferay.portal.*:com.liferay.counter.*:com.liferay.mail.*" title="Portal Services" />
			<group packages="com.liferay.portal.kernel.*" title="Portal Kernel" />
			<group packages="com.liferay.*" title="Portlet Services" />

			<link href="http://docs.liferay.com/portlet-api/3.0/javadocs" />
			<link href="http://java.sun.com/javase/6/docs/api" />
			<link href="http://docs.liferay.com/portal/${lp.version.major}-latest/javadocs" />

			<packageset dir="${module.dir}/src" />

			<tag description="{$generated.description}" name="generated" />
		</javadoc>
	</target>

	<target name="nightly">
		<fail>
.

This target has been renamed to "snapshot-bundle". Please call "snapshot-bundle" instead.
		</fail>

		<antcall target="snapshot-bundle" />
	</target>

	<target name="prepare-generated-files">
		<ant antfile="build-dist.xml" inheritAll="false" target="prepare-generated-files" />
	</target>

	<target name="propertiesdoc">
		<property name="properties.dest.dir" value="${doc.dir}/propertiesdoc" />

		<remake-dir dir="${properties.dest.dir}" />

		<antcall target="propertiesdoc-cmd">
			<param name="properties.dest.dir" value="${properties.dest.dir}" />
			<param name="properties.file" value="definitions/liferay-plugin-package_6_1_0.properties" />
			<param name="properties.title" value="Liferay Plugin Package 6.1 Properties" />
			<param name="properties.toc" value="true" />
		</antcall>

		<antcall target="propertiesdoc-cmd">
			<param name="properties.dest.dir" value="${properties.dest.dir}" />
			<param name="properties.file" value="definitions/liferay-plugin-package_6_2_0.properties" />
			<param name="properties.title" value="Liferay Plugin Package 6.2 Properties" />
			<param name="properties.toc" value="true" />
		</antcall>

		<antcall target="propertiesdoc-cmd">
			<param name="properties.dest.dir" value="${properties.dest.dir}" />
			<param name="properties.file" value="definitions/liferay-plugin-package_7_0_0.properties" />
			<param name="properties.title" value="Liferay Plugin Package 7.0 Properties" />
			<param name="properties.toc" value="true" />
		</antcall>

		<antcall target="propertiesdoc-cmd">
			<param name="properties.dest.dir" value="${properties.dest.dir}" />
			<param name="properties.file" value="definitions/liferay-plugin-package_7_1_0.properties" />
			<param name="properties.title" value="Liferay Plugin Package 7.1 Properties" />
			<param name="properties.toc" value="true" />
		</antcall>

		<antcall target="propertiesdoc-cmd">
			<param name="properties.dest.dir" value="${properties.dest.dir}" />
			<param name="properties.file" value="definitions/liferay-plugin-package_7_2_0.properties" />
			<param name="properties.title" value="Liferay Plugin Package 7.2 Properties" />
			<param name="properties.toc" value="true" />
		</antcall>

		<antcall target="propertiesdoc-cmd">
			<param name="properties.dest.dir" value="${properties.dest.dir}" />
			<param name="properties.file" value="definitions/liferay-plugin-package_7_3_0.properties" />
			<param name="properties.title" value="Liferay Plugin Package 7.3 Properties" />
			<param name="properties.toc" value="true" />
		</antcall>

		<antcall target="propertiesdoc-cmd">
			<param name="properties.dest.dir" value="${properties.dest.dir}" />
			<param name="properties.file" value="definitions/liferay-plugin-package_7_4_0.properties" />
			<param name="properties.title" value="Liferay Plugin Package 7.4 Properties" />
			<param name="properties.toc" value="true" />
		</antcall>

		<antcall target="propertiesdoc-cmd">
			<param name="properties.dest.dir" value="${properties.dest.dir}" />
			<param name="properties.file" value="portal-impl/src/portal.properties" />
			<param name="properties.title" value="Portal Properties" />
			<param name="properties.toc" value="true" />
		</antcall>

		<antcall target="propertiesdoc-cmd">
			<param name="properties.dest.dir" value="${properties.dest.dir}" />
			<param name="properties.file" value="portal-impl/src/system.properties" />
			<param name="properties.title" value="System Properties" />
			<param name="properties.toc" value="true" />
		</antcall>

		<java
			classname="com.liferay.portal.tools.propertiesdoc.PropertiesDocIndexBuilder"
			classpathref="project.classpath"
			fork="true"
			newenvironment="true"
		>
			<arg value="properties.dir=${doc.dir}/propertiesdoc" />
		</java>
	</target>

	<target name="propertiesdoc-cmd">
		<java
			classname="com.liferay.portal.tools.propertiesdoc.PropertiesDocBuilder"
			classpathref="project.classpath"
			fork="true"
			newenvironment="true"
		>
			<arg value="properties.dest.dir=${properties.dest.dir}" />
			<arg value="properties.file=${properties.file}" />
			<arg value="properties.title=${properties.title}" />
			<arg value="properties.toc=${properties.toc}" />
		</java>
	</target>

	<target name="publish-portal-release">
		<ant dir="portal-impl" inheritAll="false" target="publish-portal-release" />
		<ant dir="portal-kernel" inheritAll="false" target="publish-portal-release" />
		<ant dir="portal-test" inheritAll="false" target="publish-portal-release" />
		<ant dir="portal-web" inheritAll="false" target="publish-portal-release" />
		<ant dir="support-tomcat" inheritAll="false" target="publish-portal-release" />
		<ant dir="util-bridges" inheritAll="false" target="publish-portal-release" />
		<ant dir="util-java" inheritAll="false" target="publish-portal-release" />
		<ant dir="util-slf4j" inheritAll="false" target="publish-portal-release" />
		<ant dir="util-taglib" inheritAll="false" target="publish-portal-release" />
	</target>

	<target name="restore-latest-artifact-version">
		<ant dir="portal-impl" inheritAll="false" target="restore-latest-artifact-version" />
		<ant dir="portal-kernel" inheritAll="false" target="restore-latest-artifact-version" />
		<ant dir="portal-test" inheritAll="false" target="restore-latest-artifact-version" />
		<ant dir="portal-web" inheritAll="false" target="restore-latest-artifact-version" />
		<ant dir="support-tomcat" inheritAll="false" target="restore-latest-artifact-version" />
		<ant dir="util-bridges" inheritAll="false" target="restore-latest-artifact-version" />
		<ant dir="util-java" inheritAll="false" target="restore-latest-artifact-version" />
		<ant dir="util-slf4j" inheritAll="false" target="restore-latest-artifact-version" />
		<ant dir="util-taglib" inheritAll="false" target="restore-latest-artifact-version" />
	</target>

	<target name="setup-libs">
		<setup-libs />
	</target>

	<target name="setup-profile-dxp">
		<delete dir="git-clone-profile-dxp" />

		<local name="setup.profile.dxp.git.url" />

		<if>
			<isset property="env.JENKINS_HOME" />
			<then>
				<property name="setup.profile.dxp.git.url" value="git@github-dev.liferay.com:liferay/liferay-portal-ee.git" />
			</then>
			<else>
				<property name="setup.profile.dxp.git.url" value="git@github.com:liferay/liferay-portal-ee.git" />
			</else>
		</if>

		<exec executable="git" failonerror="true">
			<arg line="clone --branch=master-private --depth=1 --no-checkout --single-branch ${setup.profile.dxp.git.url} git-clone-profile-dxp" />
		</exec>

		<exec dir="git-clone-profile-dxp" executable="git" failonerror="true">
			<arg line="checkout refs/heads/master-private -- working.dir.properties" />
		</exec>

		<move
			file="git-clone-profile-dxp/working.dir.properties"
			todir="."
		/>

		<setup-profile-dxp
			to.branch.name="${git.working.branch.name}-private"
		/>

		<delete dir="git-clone-profile-dxp" />
		<delete file="working.dir.properties" />

		<antcall inheritAll="false" target="update-gradle-properties" />

		<if>
			<equals arg1="${build.patcher.replace.release.info.tokens}" arg2="true" />
			<then>
				<ant dir="portal-kernel" inheritAll="false" target="replace-release-info-tokens" />
			</then>
		</if>
	</target>

	<target name="setup-profile-portal">
		<delete verbose="true">
			<fileset
				dir="${project.dir}"
				includes="*.profile-dxp.properties,*/*.profile-dxp.properties"
			/>
		</delete>

		<update-gradle-properties />

		<if>
			<equals arg1="${build.patcher.replace.release.info.tokens}" arg2="true" />
			<then>
				<ant dir="portal-kernel" inheritAll="false" target="replace-release-info-tokens" />
			</then>
		</if>
	</target>

	<target name="setup-sdk">
		<setup-sdk />
	</target>

	<target name="setup-yarn">
		<setup-yarn />
	</target>

	<target depends="setup-libs" name="snapshot-bundle">
		<basename file="${snapshot.bundle.url}" property="snapshot.bundle.file" />

		<property name="snapshot.bundle.sha256.original" value="${project.dir}/tmp/${snapshot.bundle.file}.snapshot.bundle.sha256.original" />
		<property name="snapshot.bundle.sha256.new" value="${project.dir}/tmp/${snapshot.bundle.file}.snapshot.bundle.sha256.new" />

		<mirrors-get
			dest="${snapshot.bundle.sha256.original}"
			force="false"
			skipChecksum="true"
			src="${snapshot.bundle.url}.sha256"
		/>

		<mirrors-get
			dest="${snapshot.bundle.sha256.new}"
			force="true"
			skipChecksum="true"
			src="${snapshot.bundle.url}.sha256"
		/>

		<condition else="true" property="snapshot.bundle.force" value="false">
			<filesmatch file1="${snapshot.bundle.sha256.original}" file2="${snapshot.bundle.sha256.new}" />
		</condition>

		<mirrors-get
			dest="${project.dir}/tmp/${snapshot.bundle.file}"
			force="${snapshot.bundle.force}"
			skipChecksum="true"
			src="${snapshot.bundle.url}"
		/>

		<clean-liferay-home />

		<taskdef
			classpathref="lib.classpath"
			resource="org/apache/ant/compress/antlib.xml"
		/>

		<un7z
			dest="${liferay.home}"
			src="${project.dir}/tmp/${snapshot.bundle.file}"
		>
			<mapper>
				<globmapper
					from="liferay-portal-${git.working.branch.name}/*"
					to="*"
				/>
			</mapper>
			<patternset
				excludes="${snapshot.bundle.excludes}"
			/>
		</un7z>

		<condition else="liferay-portal-${git.working.branch.name}" property="snapshot.bundle.prefix.dir.name" value="liferay-portal-${git.working.branch.name}-private">
			<equals arg1="${build.profile}" arg2="dxp" />
		</condition>

		<move
			file="${liferay.home}/${snapshot.bundle.prefix.dir.name}"
			tofile="${liferay.home}"
		/>

		<deploy-properties />

		<if>
			<os family="unix" />
			<then>
				<chmod
					file="${liferay.home}/tomcat-${app.server.tomcat.version}/bin/*.sh"
					perm="a+x"
				/>
			</then>
		</if>

		<if>
			<available file="${liferay.home}/work" />
			<then>
				<touch>
					<fileset
						dir="${liferay.home}/work"
					/>
				</touch>
			</then>
		</if>
	</target>

	<target name="start">
		<antcall target="compile" />

		<echo>The "start" target is now deprecated. Please use the "compile" target instead.</echo>
	</target>

	<target name="test-package">
		<ant antfile="build-test.xml" inheritAll="false" target="test-package" />
	</target>

	<target name="test-unit">
		<ant antfile="build-test.xml" inheritAll="false" target="test-unit" />
	</target>

	<target name="update-app-server-scripts">
		<if>
			<or>
				<equals arg1="${app.server.type}" arg2="jboss" />
				<equals arg1="${app.server.type}" arg2="wildfly" />
			</or>
			<then>
				<if>
					<not>
						<available file="${app.server.lib.global.dir}/module.xml" />
					</not>
					<then>
						<copy
							file="tools/servers/jboss/modules/module.xml"
							tofile="${app.server.lib.global.dir}/module.xml"
						/>
					</then>
				</if>
			</then>
		</if>

		<if>
			<equals arg1="${app.server.type}" arg2="tomcat" />
			<then>
				<if>
					<not>
						<available file="${app.server.dir}/conf/Catalina/localhost/${app.server.tomcat.portal.context}.xml" />
					</not>
					<then>
						<copy
							file="tools/servers/tomcat/conf/Catalina/localhost/ROOT.xml"
							overwrite="true"
							tofile="${app.server.dir}/conf/Catalina/localhost/${app.server.tomcat.portal.context}.xml"
						/>
					</then>
				</if>
			</then>
		</if>

		<if>
			<equals arg1="${app.server.type}" arg2="websphere" />
			<then>
				<replace
					file="${app.server.websphere.dir}/configuration/config.ini"
				>
					<replacetoken>com.ibm.CORBA,com.ibm</replacetoken>
					<replacevalue>com.ibm.CORBA,javax.portlet,javax.portlet.filter,javax.portlet.annotations,com.ibm</replacevalue>
				</replace>

				<if>
					<os family="unix" />
					<then>
						<chmod
							file="${app.server.websphere.bin.dir}/startServer.sh"
							perm="a+x"
						/>

						<exec dir="${app.server.websphere.bin.dir}" executable="/bin/sh">
							<arg value="-c" />
							<arg value="./startServer.sh server1" />
						</exec>
					</then>
					<elseif>
						<os family="windows" />
						<then>
							<exec dir="${app.server.websphere.bin.dir}" executable="cmd.exe">
								<arg value="/c" />
								<arg value="startServer.bat server1" />
							</exec>
						</then>
					</elseif>
				</if>

				<echo>Installing liferay-portal.war.</echo>

				<echo file="wsadmin.py">
def isAppInstalled(appName):
	appNames = AdminApp.list()

	if len(appNames) > 0:
		for curAppName in appNames.split('\n'):
			curAppName = curAppName.rstrip()

			if curAppName.find(appName) >= 0:
				return 1

	return 0

if isAppInstalled('DefaultApplication'):
	print AdminApp.uninstall('DefaultApplication')

	print AdminConfig.save()

appManager = AdminControl.queryNames('type=ApplicationManager,process=server1,*')

if isAppInstalled('liferay-portal'):
	print AdminControl.invoke(appManager, 'stopApplication', 'liferay-portal')

	print AdminApp.update('liferay-portal', 'app', '[-contents ${app.server.websphere.instance.dir}/wsadmin-deploy/liferay-portal.war -contextroot / -operation update]')
else:
	print AdminApp.install('${app.server.websphere.instance.dir}/wsadmin-deploy/liferay-portal.war', '[-appname liferay-portal -contextroot / -defaultbinding.virtual.host default_host -usedefaultbindings]')

print AdminConfig.save()

print AdminControl.invoke(appManager, 'startApplication', 'liferay-portal')
				</echo>

				<if>
					<os family="unix" />
					<then>
						<exec dir="${app.server.websphere.bin.dir}" executable="/bin/sh">
							<arg value="-c" />
							<arg value="./wsadmin.sh -f ${basedir}/wsadmin.py" />
						</exec>

						<exec dir="${app.server.websphere.bin.dir}" executable="/bin/sh">
							<arg value="-c" />
							<arg value="./stopServer.sh server1" />
						</exec>
					</then>
					<elseif>
						<os family="windows" />
						<then>
							<exec dir="${app.server.websphere.bin.dir}" executable="cmd.exe">
								<arg value="/c" />
								<arg value="wsadmin.bat -f ${basedir}\wsadmin.py" />
							</exec>

							<exec dir="${app.server.websphere.bin.dir}" executable="cmd.exe">
								<arg value="/c" />
								<arg value="stopServer.bat server1" />
							</exec>
						</then>
					</elseif>
				</if>

				<delete file="wsadmin.py" />
			</then>
		</if>
	</target>

	<target name="update-binaries-cache">
		<copy
			overwrite="false"
			todir="${build.binaries.cache.dir}/.gradle/caches/modules-2/files-2.1"
		>
			<fileset
				dir="${project.dir}/.gradle/caches/modules-2/files-2.1"
			>
				<size units="Mi" value="100" when="less" />
			</fileset>
		</copy>

		<gradle-execute dir="${project.dir}/modules" task="updateYarnBinariesCache">
			<arg value="--build-file=${project.dir}/modules/util.gradle" />
		</gradle-execute>
	</target>

	<target name="update-gradle-cache">
		<execute>
			git reset --hard HEAD

			git clean -df
		</execute>

		<delete dir="${basedir}/.gradle" />

		<setup-sdk setupbinariescache="false" />

		<gradle-execute dir="modules" forcedcacheenabled="false" setupbinariescache="false" task="clean">
			<arg value="--continue" />
			<arg value="--parallel" />
		</gradle-execute>

		<gradle-execute dir="modules" forcedcacheenabled="false" setupbinariescache="false" task="classes">
			<arg value="--continue" />
			<arg value="--parallel" />
			<arg value="testClasses" />
			<arg value="testIntegrationClasses" />
		</gradle-execute>

		<gradle-execute dir="modules/sdk/gradle-util" failonerror="false" forcedcacheenabled="false" setupbinariescache="false" task="spotbugsMain">
			<arg value="--continue" />
			<arg value="--parallel" />
		</gradle-execute>

		<ant dir="portal-web" inheritAll="false" target="update-gradle-cache" />

		<echo append="true" file="${basedir}/.gitignore">
!/.gradle
/.gradle/*
!/.gradle/caches
/.gradle/caches/*
!/.gradle/caches/modules-2
/.gradle/caches/modules-2/*
!/.gradle/caches/modules-2/files-2.1</echo>

		<execute>
			git add --all
			git checkout HEAD -- .gitignore
		</execute>
	</target>

	<target name="update-portal-osgi-configuration-properties">
		<pathconvert pathsep="," property="configuration.java.files">
			<fileset
				dir="modules"
				excludes=""
				includes="**/apps/**/configuration/*Configuration.java"
			>
			</fileset>
		</pathconvert>

		<java
			classname="com.liferay.portal.tools.ConfigurationEnvBuilder"
			classpathref="project.classpath"
			dir="${project.dir}/modules"
			fork="${fork.mode}"
			newenvironment="true"
		>
			<arg value="configuration.java.files=${configuration.java.files}" />
			<arg value="output.file=${project.dir}/portal-impl/src/portal-osgi-configuration.properties" />
			<jvmarg if:true="${jvm.debug}" line="${jpda.settings}" />
		</java>
	</target>

	<target name="validate-xml">
		<xmlvalidate failonerror="no">
			<fileset
				dir="${project.dir}"
				excludes="**/dependencies/**,**/ehcache/**"
				includes="**/liferay-*.xml,**/web.xml"
			/>
			<xmlcatalog>
				<dtd location="datatypes.dtd" publicId="datatypes" />
				<dtd location="${definitions.dir}/facelet-taglib_1_0.dtd" publicId="-//Sun Microsystems, Inc.//DTD Facelet Taglib 1.0//EN" />
				<dtd location="${definitions.dir}/liferay-display_2_0_0.dtd" publicId="-//Liferay//DTD DISPLAY 2.0.0//EN" />
				<dtd location="${definitions.dir}/liferay-display_3_5_0.dtd" publicId="-//Liferay//DTD Display 3.5.0//EN" />
				<dtd location="${definitions.dir}/liferay-display_4_0_0.dtd" publicId="-//Liferay//DTD Display 4.0.0//EN" />
				<dtd location="${definitions.dir}/liferay-display_5_0_0.dtd" publicId="-//Liferay//DTD Display 5.0.0//EN" />
				<dtd location="${definitions.dir}/liferay-display_5_1_0.dtd" publicId="-//Liferay//DTD Display 5.1.0//EN" />
				<dtd location="${definitions.dir}/liferay-display_5_2_0.dtd" publicId="-//Liferay//DTD Display 5.2.0//EN" />
				<dtd location="${definitions.dir}/liferay-display_6_0_0.dtd" publicId="-//Liferay//DTD Display 6.0.0//EN" />
				<dtd location="${definitions.dir}/liferay-display_6_1_0.dtd" publicId="-//Liferay//DTD Display 6.1.0//EN" />
				<dtd location="${definitions.dir}/liferay-display_6_2_0.dtd" publicId="-//Liferay//DTD Display 6.2.0//EN" />
				<dtd location="${definitions.dir}/liferay-display_7_0_0.dtd" publicId="-//Liferay//DTD Display 7.0.0//EN" />
				<dtd location="${definitions.dir}/liferay-display_7_1_0.dtd" publicId="-//Liferay//DTD Display 7.1.0//EN" />
				<dtd location="${definitions.dir}/liferay-display_7_2_0.dtd" publicId="-//Liferay//DTD Display 7.2.0//EN" />
				<dtd location="${definitions.dir}/liferay-display_7_3_0.dtd" publicId="-//Liferay//DTD Display 7.3.0//EN" />
				<dtd location="${definitions.dir}/liferay-display_7_4_0.dtd" publicId="-//Liferay//DTD Display 7.4.0//EN" />
				<dtd location="${definitions.dir}/liferay-friendly-url-routes_6_0_0.dtd" publicId="-//Liferay//DTD Friendly URL Routes 6.0.0//EN" />
				<dtd location="${definitions.dir}/liferay-friendly-url-routes_6_1_0.dtd" publicId="-//Liferay//DTD Friendly URL Routes 6.1.0//EN" />
				<dtd location="${definitions.dir}/liferay-friendly-url-routes_6_2_0.dtd" publicId="-//Liferay//DTD Friendly URL Routes 6.2.0//EN" />
				<dtd location="${definitions.dir}/liferay-friendly-url-routes_7_0_0.dtd" publicId="-//Liferay//DTD Friendly URL Routes 7.0.0//EN" />
				<dtd location="${definitions.dir}/liferay-friendly-url-routes_7_1_0.dtd" publicId="-//Liferay//DTD Friendly URL Routes 7.1.0//EN" />
				<dtd location="${definitions.dir}/liferay-friendly-url-routes_7_2_0.dtd" publicId="-//Liferay//DTD Friendly URL Routes 7.2.0//EN" />
				<dtd location="${definitions.dir}/liferay-friendly-url-routes_7_3_0.dtd" publicId="-//Liferay//DTD Friendly URL Routes 7.3.0//EN" />
				<dtd location="${definitions.dir}/liferay-friendly-url-routes_7_4_0.dtd" publicId="-//Liferay//DTD Friendly URL Routes 7.4.0//EN" />
				<dtd location="${definitions.dir}/liferay-hook_5_1_0.dtd" publicId="-//Liferay//DTD Hook 5.1.0//EN" />
				<dtd location="${definitions.dir}/liferay-hook_5_2_0.dtd" publicId="-//Liferay//DTD Hook 5.2.0//EN" />
				<dtd location="${definitions.dir}/liferay-hook_6_0_0.dtd" publicId="-//Liferay//DTD Hook 6.0.0//EN" />
				<dtd location="${definitions.dir}/liferay-hook_6_1_0.dtd" publicId="-//Liferay//DTD Hook 6.1.0//EN" />
				<dtd location="${definitions.dir}/liferay-hook_6_2_0.dtd" publicId="-//Liferay//DTD Hook 6.2.0//EN" />
				<dtd location="${definitions.dir}/liferay-hook_7_0_0.dtd" publicId="-//Liferay//DTD Hook 7.0.0//EN" />
				<dtd location="${definitions.dir}/liferay-hook_7_1_0.dtd" publicId="-//Liferay//DTD Hook 7.1.0//EN" />
				<dtd location="${definitions.dir}/liferay-hook_7_2_0.dtd" publicId="-//Liferay//DTD Hook 7.2.0//EN" />
				<dtd location="${definitions.dir}/liferay-hook_7_3_0.dtd" publicId="-//Liferay//DTD Hook 7.3.0//EN" />
				<dtd location="${definitions.dir}/liferay-hook_7_4_0.dtd" publicId="-//Liferay//DTD Hook 7.4.0//EN" />
				<dtd location="${definitions.dir}/liferay-layout-templates_3_6_0.dtd" publicId="-//Liferay//DTD Layout Templates 3.6.0//EN" />
				<dtd location="${definitions.dir}/liferay-layout-templates_4_0_0.dtd" publicId="-//Liferay//DTD Layout Templates 4.0.0//EN" />
				<dtd location="${definitions.dir}/liferay-layout-templates_4_3_0.dtd" publicId="-//Liferay//DTD Layout Templates 4.3.0//EN" />
				<dtd location="${definitions.dir}/liferay-layout-templates_5_0_0.dtd" publicId="-//Liferay//DTD Layout Templates 5.0.0//EN" />
				<dtd location="${definitions.dir}/liferay-layout-templates_5_1_0.dtd" publicId="-//Liferay//DTD Layout Templates 5.1.0//EN" />
				<dtd location="${definitions.dir}/liferay-layout-templates_5_2_0.dtd" publicId="-//Liferay//DTD Layout Templates 5.2.0//EN" />
				<dtd location="${definitions.dir}/liferay-layout-templates_6_0_0.dtd" publicId="-//Liferay//DTD Layout Templates 6.0.0//EN" />
				<dtd location="${definitions.dir}/liferay-layout-templates_6_1_0.dtd" publicId="-//Liferay//DTD Layout Templates 6.1.0//EN" />
				<dtd location="${definitions.dir}/liferay-layout-templates_6_2_0.dtd" publicId="-//Liferay//DTD Layout Templates 6.2.0//EN" />
				<dtd location="${definitions.dir}/liferay-layout-templates_7_0_0.dtd" publicId="-//Liferay//DTD Layout Templates 7.0.0//EN" />
				<dtd location="${definitions.dir}/liferay-layout-templates_7_1_0.dtd" publicId="-//Liferay//DTD Layout Templates 7.1.0//EN" />
				<dtd location="${definitions.dir}/liferay-layout-templates_7_2_0.dtd" publicId="-//Liferay//DTD Layout Templates 7.2.0//EN" />
				<dtd location="${definitions.dir}/liferay-layout-templates_7_3_0.dtd" publicId="-//Liferay//DTD Layout Templates 7.3.0//EN" />
				<dtd location="${definitions.dir}/liferay-layout-templates_7_4_0.dtd" publicId="-//Liferay//DTD Layout Templates 7.4.0//EN" />
				<dtd location="${definitions.dir}/liferay-look-and-feel_3_5_0.dtd" publicId="-//Liferay//DTD Look and Feel 3.5.0//EN" />
				<dtd location="${definitions.dir}/liferay-look-and-feel_4_0_0.dtd" publicId="-//Liferay//DTD Look and Feel 4.0.0//EN" />
				<dtd location="${definitions.dir}/liferay-look-and-feel_4_3_0.dtd" publicId="-//Liferay//DTD Look and Feel 4.3.0//EN" />
				<dtd location="${definitions.dir}/liferay-look-and-feel_5_0_0.dtd" publicId="-//Liferay//DTD Look and Feel 5.0.0//EN" />
				<dtd location="${definitions.dir}/liferay-look-and-feel_5_1_0.dtd" publicId="-//Liferay//DTD Look and Feel 5.1.0//EN" />
				<dtd location="${definitions.dir}/liferay-look-and-feel_5_2_0.dtd" publicId="-//Liferay//DTD Look and Feel 5.2.0//EN" />
				<dtd location="${definitions.dir}/liferay-look-and-feel_6_0_0.dtd" publicId="-//Liferay//DTD Look and Feel 6.0.0//EN" />
				<dtd location="${definitions.dir}/liferay-look-and-feel_6_1_0.dtd" publicId="-//Liferay//DTD Look and Feel 6.1.0//EN" />
				<dtd location="${definitions.dir}/liferay-look-and-feel_6_2_0.dtd" publicId="-//Liferay//DTD Look and Feel 6.2.0//EN" />
				<dtd location="${definitions.dir}/liferay-look-and-feel_7_0_0.dtd" publicId="-//Liferay//DTD Look and Feel 7.0.0//EN" />
				<dtd location="${definitions.dir}/liferay-look-and-feel_7_1_0.dtd" publicId="-//Liferay//DTD Look and Feel 7.1.0//EN" />
				<dtd location="${definitions.dir}/liferay-look-and-feel_7_2_0.dtd" publicId="-//Liferay//DTD Look and Feel 7.2.0//EN" />
				<dtd location="${definitions.dir}/liferay-look-and-feel_7_3_0.dtd" publicId="-//Liferay//DTD Look and Feel 7.3.0//EN" />
				<dtd location="${definitions.dir}/liferay-look-and-feel_7_4_0.dtd" publicId="-//Liferay//DTD Look and Feel 7.4.0//EN" />
				<dtd location="${definitions.dir}/liferay-plugin-package_4_3_0.dtd" publicId="-//Liferay//DTD Plugin Package 4.3.0//EN" />
				<dtd location="${definitions.dir}/liferay-plugin-package_5_0_0.dtd" publicId="-//Liferay//DTD Plugin Package 5.0.0//EN" />
				<dtd location="${definitions.dir}/liferay-plugin-package_5_1_0.dtd" publicId="-//Liferay//DTD Plugin Package 5.1.0//EN" />
				<dtd location="${definitions.dir}/liferay-plugin-package_5_2_0.dtd" publicId="-//Liferay//DTD Plugin Package 5.2.0//EN" />
				<dtd location="${definitions.dir}/liferay-plugin-package_6_0_0.dtd" publicId="-//Liferay//DTD Plugin Package 6.0.0//EN" />
				<dtd location="${definitions.dir}/liferay-plugin-package_6_1_0.dtd" publicId="-//Liferay//DTD Plugin Package 6.1.0//EN" />
				<dtd location="${definitions.dir}/liferay-plugin-package_6_2_0.dtd" publicId="-//Liferay//DTD Plugin Package 6.2.0//EN" />
				<dtd location="${definitions.dir}/liferay-plugin-package_7_0_0.dtd" publicId="-//Liferay//DTD Plugin Package 7.0.0//EN" />
				<dtd location="${definitions.dir}/liferay-plugin-package_7_1_0.dtd" publicId="-//Liferay//DTD Plugin Package 7.1.0//EN" />
				<dtd location="${definitions.dir}/liferay-plugin-package_7_2_0.dtd" publicId="-//Liferay//DTD Plugin Package 7.2.0//EN" />
				<dtd location="${definitions.dir}/liferay-plugin-package_7_3_0.dtd" publicId="-//Liferay//DTD Plugin Package 7.3.0//EN" />
				<dtd location="${definitions.dir}/liferay-plugin-package_7_4_0.dtd" publicId="-//Liferay//DTD Plugin Package 7.4.0//EN" />
				<dtd location="${definitions.dir}/liferay-plugin-repository_4_3_0.dtd" publicId="-//Liferay//DTD Plugin Repository 4.3.0//EN" />
				<dtd location="${definitions.dir}/liferay-plugin-repository_5_0_0.dtd" publicId="-//Liferay//DTD Plugin Repository 5.0.0//EN" />
				<dtd location="${definitions.dir}/liferay-plugin-repository_5_1_0.dtd" publicId="-//Liferay//DTD Plugin Repository 5.1.0//EN" />
				<dtd location="${definitions.dir}/liferay-plugin-repository_5_2_0.dtd" publicId="-//Liferay//DTD Plugin Repository 5.2.0//EN" />
				<dtd location="${definitions.dir}/liferay-plugin-repository_6_0_0.dtd" publicId="-//Liferay//DTD Plugin Repository 6.0.0//EN" />
				<dtd location="${definitions.dir}/liferay-plugin-repository_6_1_0.dtd" publicId="-//Liferay//DTD Plugin Repository 6.1.0//EN" />
				<dtd location="${definitions.dir}/liferay-plugin-repository_6_2_0.dtd" publicId="-//Liferay//DTD Plugin Repository 6.2.0//EN" />
				<dtd location="${definitions.dir}/liferay-plugin-repository_7_0_0.dtd" publicId="-//Liferay//DTD Plugin Repository 7.0.0//EN" />
				<dtd location="${definitions.dir}/liferay-plugin-repository_7_1_0.dtd" publicId="-//Liferay//DTD Plugin Repository 7.1.0//EN" />
				<dtd location="${definitions.dir}/liferay-plugin-repository_7_2_0.dtd" publicId="-//Liferay//DTD Plugin Repository 7.2.0//EN" />
				<dtd location="${definitions.dir}/liferay-plugin-repository_7_3_0.dtd" publicId="-//Liferay//DTD Plugin Repository 7.3.0//EN" />
				<dtd location="${definitions.dir}/liferay-plugin-repository_7_4_0.dtd" publicId="-//Liferay//DTD Plugin Repository 7.4.0//EN" />
				<dtd location="${definitions.dir}/liferay-portlet_2_0_0.dtd" publicId="-//Liferay//DTD PORTLET 2.0.0//EN" />
				<dtd location="${definitions.dir}/liferay-portlet_2_2_0.dtd" publicId="-//Liferay//DTD PORTLET 2.2.0//EN" />
				<dtd location="${definitions.dir}/liferay-portlet-app_3_5_0.dtd" publicId="-//Liferay//DTD Portlet Application 3.5.0//EN" />
				<dtd location="${definitions.dir}/liferay-portlet-app_4_0_0.dtd" publicId="-//Liferay//DTD Portlet Application 4.0.0//EN" />
				<dtd location="${definitions.dir}/liferay-portlet-app_4_1_0.dtd" publicId="-//Liferay//DTD Portlet Application 4.1.0//EN" />
				<dtd location="${definitions.dir}/liferay-portlet-app_4_2_0.dtd" publicId="-//Liferay//DTD Portlet Application 4.2.0//EN" />
				<dtd location="${definitions.dir}/liferay-portlet-app_4_3_0.dtd" publicId="-//Liferay//DTD Portlet Application 4.3.0//EN" />
				<dtd location="${definitions.dir}/liferay-portlet-app_4_3_1.dtd" publicId="-//Liferay//DTD Portlet Application 4.3.1//EN" />
				<dtd location="${definitions.dir}/liferay-portlet-app_4_3_2.dtd" publicId="-//Liferay//DTD Portlet Application 4.3.2//EN" />
				<dtd location="${definitions.dir}/liferay-portlet-app_4_3_3.dtd" publicId="-//Liferay//DTD Portlet Application 4.3.3//EN" />
				<dtd location="${definitions.dir}/liferay-portlet-app_4_4_0.dtd" publicId="-//Liferay//DTD Portlet Application 4.4.0//EN" />
				<dtd location="${definitions.dir}/liferay-portlet-app_5_0_0.dtd" publicId="-//Liferay//DTD Portlet Application 5.0.0//EN" />
				<dtd location="${definitions.dir}/liferay-portlet-app_5_1_0.dtd" publicId="-//Liferay//DTD Portlet Application 5.1.0//EN" />
				<dtd location="${definitions.dir}/liferay-portlet-app_5_2_0.dtd" publicId="-//Liferay//DTD Portlet Application 5.2.0//EN" />
				<dtd location="${definitions.dir}/liferay-portlet-app_6_0_0.dtd" publicId="-//Liferay//DTD Portlet Application 6.0.0//EN" />
				<dtd location="${definitions.dir}/liferay-portlet-app_6_1_0.dtd" publicId="-//Liferay//DTD Portlet Application 6.1.0//EN" />
				<dtd location="${definitions.dir}/liferay-portlet-app_6_2_0.dtd" publicId="-//Liferay//DTD Portlet Application 6.2.0//EN" />
				<dtd location="${definitions.dir}/liferay-portlet-app_7_0_0.dtd" publicId="-//Liferay//DTD Portlet Application 7.0.0//EN" />
				<dtd location="${definitions.dir}/liferay-portlet-app_7_1_0.dtd" publicId="-//Liferay//DTD Portlet Application 7.1.0//EN" />
				<dtd location="${definitions.dir}/liferay-portlet-app_7_2_0.dtd" publicId="-//Liferay//DTD Portlet Application 7.2.0//EN" />
				<dtd location="${definitions.dir}/liferay-portlet-app_7_3_0.dtd" publicId="-//Liferay//DTD Portlet Application 7.3.0//EN" />
				<dtd location="${definitions.dir}/liferay-portlet-app_7_4_0.dtd" publicId="-//Liferay//DTD Portlet Application 7.4.0//EN" />
				<dtd location="${definitions.dir}/liferay-resource-action-mapping_6_0_0.dtd" publicId="-//Liferay//DTD Resource Action Mapping 6.0.0//EN" />
				<dtd location="${definitions.dir}/liferay-resource-action-mapping_6_1_0.dtd" publicId="-//Liferay//DTD Resource Action Mapping 6.1.0//EN" />
				<dtd location="${definitions.dir}/liferay-resource-action-mapping_6_2_0.dtd" publicId="-//Liferay//DTD Resource Action Mapping 6.2.0//EN" />
				<dtd location="${definitions.dir}/liferay-resource-action-mapping_7_0_0.dtd" publicId="-//Liferay//DTD Resource Action Mapping 7.0.0//EN" />
				<dtd location="${definitions.dir}/liferay-resource-action-mapping_7_1_0.dtd" publicId="-//Liferay//DTD Resource Action Mapping 7.1.0//EN" />
				<dtd location="${definitions.dir}/liferay-resource-action-mapping_7_2_0.dtd" publicId="-//Liferay//DTD Resource Action Mapping 7.2.0//EN" />
				<dtd location="${definitions.dir}/liferay-resource-action-mapping_7_3_0.dtd" publicId="-//Liferay//DTD Resource Action Mapping 7.3.0//EN" />
				<dtd location="${definitions.dir}/liferay-resource-action-mapping_7_4_0.dtd" publicId="-//Liferay//DTD Resource Action Mapping 7.4.0//EN" />
				<dtd location="${definitions.dir}/liferay-service-builder_3_5_0.dtd" publicId="-//Liferay//DTD Service Builder 3.5.0//EN" />
				<dtd location="${definitions.dir}/liferay-service-builder_3_6_1.dtd" publicId="-//Liferay//DTD Service Builder 3.6.1//EN" />
				<dtd location="${definitions.dir}/liferay-service-builder_4_0_0.dtd" publicId="-//Liferay//DTD Service Builder 4.0.0//EN" />
				<dtd location="${definitions.dir}/liferay-service-builder_4_2_0.dtd" publicId="-//Liferay//DTD Service Builder 4.2.0//EN" />
				<dtd location="${definitions.dir}/liferay-service-builder_4_3_0.dtd" publicId="-//Liferay//DTD Service Builder 4.3.0//EN" />
				<dtd location="${definitions.dir}/liferay-service-builder_4_3_3.dtd" publicId="-//Liferay//DTD Service Builder 4.3.3//EN" />
				<dtd location="${definitions.dir}/liferay-service-builder_4_4_0.dtd" publicId="-//Liferay//DTD Service Builder 4.4.0//EN" />
				<dtd location="${definitions.dir}/liferay-service-builder_5_0_0.dtd" publicId="-//Liferay//DTD Service Builder 5.0.0//EN" />
				<dtd location="${definitions.dir}/liferay-service-builder_5_1_0.dtd" publicId="-//Liferay//DTD Service Builder 5.1.0//EN" />
				<dtd location="${definitions.dir}/liferay-service-builder_5_2_0.dtd" publicId="-//Liferay//DTD Service Builder 5.2.0//EN" />
				<dtd location="${definitions.dir}/liferay-service-builder_6_0_0.dtd" publicId="-//Liferay//DTD Service Builder 6.0.0//EN" />
				<dtd location="${definitions.dir}/liferay-service-builder_6_1_0.dtd" publicId="-//Liferay//DTD Service Builder 6.1.0//EN" />
				<dtd location="${definitions.dir}/liferay-service-builder_6_2_0.dtd" publicId="-//Liferay//DTD Service Builder 6.2.0//EN" />
				<dtd location="${definitions.dir}/liferay-service-builder_7_0_0.dtd" publicId="-//Liferay//DTD Service Builder 7.0.0//EN" />
				<dtd location="${definitions.dir}/liferay-service-builder_7_1_0.dtd" publicId="-//Liferay//DTD Service Builder 7.1.0//EN" />
				<dtd location="${definitions.dir}/liferay-service-builder_7_2_0.dtd" publicId="-//Liferay//DTD Service Builder 7.2.0//EN" />
				<dtd location="${definitions.dir}/liferay-service-builder_7_3_0.dtd" publicId="-//Liferay//DTD Service Builder 7.3.0//EN" />
				<dtd location="${definitions.dir}/liferay-service-builder_7_4_0.dtd" publicId="-//Liferay//DTD Service Builder 7.4.0//EN" />
				<dtd location="${definitions.dir}/liferay-skin_2_0_0.dtd" publicId="-//Liferay//DTD SKIN 2.0.0//EN" />
				<dtd location="${definitions.dir}/liferay-social_6_1_0.dtd" publicId="-//Liferay//DTD Social 6.1.0//EN" />
				<dtd location="${definitions.dir}/liferay-social_6_2_0.dtd" publicId="-//Liferay//DTD Social 6.2.0//EN" />
				<dtd location="${definitions.dir}/liferay-social_7_0_0.dtd" publicId="-//Liferay//DTD Social 7.0.0//EN" />
				<dtd location="${definitions.dir}/liferay-social_7_1_0.dtd" publicId="-//Liferay//DTD Social 7.1.0//EN" />
				<dtd location="${definitions.dir}/liferay-social_7_2_0.dtd" publicId="-//Liferay//DTD Social 7.2.0//EN" />
				<dtd location="${definitions.dir}/liferay-social_7_3_0.dtd" publicId="-//Liferay//DTD Social 7.3.0//EN" />
				<dtd location="${definitions.dir}/liferay-social_7_4_0.dtd" publicId="-//Liferay//DTD Social 7.4.0//EN" />
				<dtd location="${definitions.dir}/liferay-theme-loader_4_3_0.dtd" publicId="-//Liferay//DTD Theme Loader 4.3.0//EN" />
				<dtd location="${definitions.dir}/liferay-theme-loader_5_0_0.dtd" publicId="-//Liferay//DTD Theme Loader 5.0.0//EN" />
				<dtd location="${definitions.dir}/liferay-theme-loader_5_1_0.dtd" publicId="-//Liferay//DTD Theme Loader 5.1.0//EN" />
				<dtd location="${definitions.dir}/liferay-theme-loader_5_2_0.dtd" publicId="-//Liferay//DTD Theme Loader 5.2.0//EN" />
				<dtd location="${definitions.dir}/liferay-theme-loader_6_0_0.dtd" publicId="-//Liferay//DTD Theme Loader 6.0.0//EN" />
				<dtd location="${definitions.dir}/liferay-theme-loader_6_1_0.dtd" publicId="-//Liferay//DTD Theme Loader 6.1.0//EN" />
				<dtd location="${definitions.dir}/liferay-theme-loader_6_2_0.dtd" publicId="-//Liferay//DTD Theme Loader 6.2.0//EN" />
				<dtd location="${definitions.dir}/liferay-theme-loader_7_0_0.dtd" publicId="-//Liferay//DTD Theme Loader 7.0.0//EN" />
				<dtd location="${definitions.dir}/liferay-theme-loader_7_1_0.dtd" publicId="-//Liferay//DTD Theme Loader 7.1.0//EN" />
				<dtd location="${definitions.dir}/liferay-theme-loader_7_2_0.dtd" publicId="-//Liferay//DTD Theme Loader 7.2.0//EN" />
				<dtd location="${definitions.dir}/liferay-theme-loader_7_3_0.dtd" publicId="-//Liferay//DTD Theme Loader 7.3.0//EN" />
				<dtd location="${definitions.dir}/liferay-theme-loader_7_4_0.dtd" publicId="-//Liferay//DTD Theme Loader 7.4.0//EN" />
				<dtd location="${definitions.dir}/liferay-user-notification-definitions_6_2_0.dtd" publicId="-//Liferay//DTD User Notification Definition 6.2.0//EN" />
				<dtd location="${definitions.dir}/liferay-user-notification-definitions_7_0_0.dtd" publicId="-//Liferay//DTD User Notification Definition 7.0.0//EN" />
				<dtd location="${definitions.dir}/liferay-user-notification-definitions_7_1_0.dtd" publicId="-//Liferay//DTD User Notification Definition 7.1.0//EN" />
				<dtd location="${definitions.dir}/liferay-user-notification-definitions_7_2_0.dtd" publicId="-//Liferay//DTD User Notification Definition 7.2.0//EN" />
				<dtd location="${definitions.dir}/liferay-user-notification-definitions_7_3_0.dtd" publicId="-//Liferay//DTD User Notification Definition 7.3.0//EN" />
				<dtd location="${definitions.dir}/liferay-user-notification-definitions_7_4_0.dtd" publicId="-//Liferay//DTD User Notification Definition 7.4.0//EN" />
				<dtd location="${definitions.dir}/mule-configuration.dtd" publicId="-//MuleSource //DTD mule-configuration XML V1.0//EN" />
				<dtd location="${definitions.dir}/spring-beans.dtd" publicId="-//SPRING//DTD BEAN//EN" />
				<dtd location="${definitions.dir}/web-app_2_3.dtd" publicId="-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN" />
				<dtd location="${definitions.dir}/web-facesconfig_1_0.dtd" publicId="-//Sun Microsystems, Inc.//DTD JavaServer Faces Config 1.0//EN" />
				<dtd location="${definitions.dir}/web-facesconfig_1_1.dtd" publicId="-//Sun Microsystems, Inc.//DTD JavaServer Faces Config 1.1//EN" />
				<dtd location="${definitions.dir}/XMLSchema.dtd" publicId="-//W3C//DTD XMLSCHEMA 200102//EN" />
			</xmlcatalog>
		</xmlvalidate>
	</target>
</project>