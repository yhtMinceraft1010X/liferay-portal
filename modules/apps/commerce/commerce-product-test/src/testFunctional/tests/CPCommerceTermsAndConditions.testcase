@component-name = "portal-commerce"
definition {

	property portal.release = "true";
	property portal.upstream = "true";
	property testray.main.component.name = "Product Info Management";

	setUp {
		TestCase.setUpPortalInstance();

		User.firstLoginPG();
	}

	tearDown {
		Navigator.openURL();

		if (IsElementPresent(locator1 = "UserBar#USER_AVATAR_IMAGE")) {
			User.logoutPG();
		}

		User.firstLoginPG();

		CommerceConfiguration.commerceAdminTearDown();

		CommerceConfiguration.commerceInitializersTearDown();
	}

	@description = "[Please Update]"
	@ignore = "Test Stub"
	@priority = "4"
	test AddADefaultDeliveryTerm {
		property portal.acceptance = "false";

		// TODO COMMERCE-8332 AddADefaultDeliveryTerm pending implementation

	}

	@description = "[Please Update]"
	@ignore = "Test Stub"
	@priority = "4"
	test AddADefaultPaymentTerm {
		property portal.acceptance = "false";

		// TODO COMMERCE-8319 AddADefaultPaymentTerm pending implementation

	}

	@description = "[Please Update]"
	@ignore = "Test Stub"
	@priority = "4"
	test RemoveADeliveryTermLinkedToAnAccountAsDefaultOne {
		property portal.acceptance = "false";

		// TODO COMMERCE-8333 RemoveADeliveryTermLinkedToAnAccountAsDefaultOne pending implementation

	}

	@description = "This is a test for COMMERCE-8320. Delete an account default payment term will revert to "Use Priority Settings"."
	@priority = "4"
	test RemoveAPaymentTermLinkedToAnAccountAsDefaultOne {
		property portal.acceptance = "false";

		task ("Given the Sales Manager created two payment terms entries with different priority into "Terms and Conditions".") {
			CommerceNavigator.gotoPortlet(
				category = "Order Management",
				portlet = "Terms and Conditions");

			CommercePaymentTerms.addTermsAndCondition(
				active = "true",
				termsAndConditionName = "Terms and Condition Entry 1",
				termsAndConditionType = "Payment Terms",
				valuePosition = "1");

			Click(locator1 = "Icon#BACK");

			CommercePaymentTerms.addTermsAndCondition(
				active = "true",
				termsAndConditionName = "Terms and Condition Entry 2",
				termsAndConditionType = "Payment Terms",
				valuePosition = "2");
		}

		task ("Given the Sales Manager created an account with a specific default payment term already selected.") {
			JSONAccountEntry.addAccountEntry(
				accountEntryName = "Account Name",
				accountEntryType = "Business");

			Accounts.openAccountsAdmin();

			LexiconEntry.gotoEntry(rowEntry = "Account Name");

			Accounts.gotoAssigneeTab(assigneeTab = "Order Defaults");

			Accounts.setDefaultPaymentCommerceTermsEntry(termEntry = "terms-and-condition-entry-1");

			Accounts.gotoAssigneeTab(assigneeTab = "Order Defaults");

			Accounts.viewDefaultPaymentCommerceTermsEntry(termEntry = "terms-and-condition-entry-1");
		}

		task ("When the Sales Manager delete the payment term that was linked to an Account as a default") {
			CommerceNavigator.gotoPortlet(
				category = "Order Management",
				portlet = "Terms and Conditions");

			CommercePaymentTerms.gotoEntryMenuItem(
				menuItem = "Delete",
				termsAndConditionName = "Terms and Condition Entry 1");

			CommercePaymentTerms.viewDeleteTermsAndConditionEntry(termsAndConditionName = "Terms and Condition Entry 1");
		}

		task ("And go into the account edit page") {
			Accounts.openAccountsAdmin();

			Accounts.goToEntryMenuItem(
				menuItem = "Edit",
				rowEntry = "Account Name");

			Accounts.gotoAssigneeTab(assigneeTab = "Order Defaults");
		}

		task ("Then the default payment is changed to "Use Priority Settings".") {
			Accounts.viewDefaultPaymentCommerceTermsEntry();
		}
	}

	@description = "[Please Update]"
	@ignore = "Test Stub"
	@priority = "4"
	test SetAnInactiveDeliveryTermLinkedToAnAccountAsDefaultOne {
		property portal.acceptance = "false";

		// TODO COMMERCE-8334 SetAnInactiveDeliveryTermLinkedToAnAccountAsDefaultOne pending implementation

	}

	@description = "This is a test for COMMERCE-8328. If the payment term set for the account is changed to inactive, the default term remains shown but inactive"
	@priority = "4"
	test SetAnInactivePaymentTermLinkedToAnAccountAsDefaultOne {
		property portal.acceptance = "false";

		task ("Given a new entry into the "Terms and Conditions" with status to "Active".") {
			CommerceNavigator.gotoPortlet(
				category = "Order Management",
				portlet = "Terms and Conditions");

			CommercePaymentTerms.addTermsAndCondition(
				active = "true",
				termsAndConditionName = "Terms and Condition Entry 1",
				termsAndConditionType = "Payment Terms",
				valuePosition = "1");

			Click(locator1 = "Button#BACK");
		}

		task ("Given an account with a specific default payment term already selected.") {
			JSONAccountEntry.addAccountEntry(
				accountEntryName = "Account Name",
				accountEntryType = "Business");

			Accounts.openAccountsAdmin();

			LexiconEntry.gotoEntry(rowEntry = "Account Name");

			Accounts.gotoAssigneeTab(assigneeTab = "Order Defaults");

			Accounts.setDefaultPaymentCommerceTermsEntry(termEntry = "terms-and-condition-entry-1");
		}

		task ("When the Sales Manager set the payment term that was linked to an account as "inactive".") {
			CommerceNavigator.gotoPortlet(
				category = "Order Management",
				portlet = "Terms and Conditions");

			CommercePaymentTerms.gotoEntryMenuItem(
				menuItem = "Edit",
				termsAndConditionName = "Terms and Condition Entry 1");

			ClickNoError(locator1 = "ToggleSwitch#ACTIVE");

			Button.clickPublish();

			Alert.viewSuccessMessage();
		}

		task ("And go into the account edit order page") {
			Accounts.openAccountsAdmin();

			Accounts.goToEntryMenuItem(
				menuItem = "Edit",
				rowEntry = "Account Name");

			Accounts.gotoAssigneeTab(assigneeTab = "Order Defaults");
		}

		task ("Then near the default payment appear an orange triangle") {
			Accounts.viewDefaultPaymentCommerceTermsEntry(
				inactive = "true",
				termEntry = "terms-and-condition-entry-1");
		}

		task ("And if we move the mouse over the triangle the word "Inactive" appears.") {
			MouseOver(
				locator1 = "Account#DEFAULT_ACCOUNT_TERMS_AND_CONDITION_DEFAULT_PAYMENT_ENTRY_INACTIVE_ICON",
				value1 = "Inactive term");
		}
	}

}